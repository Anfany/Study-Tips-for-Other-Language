# SQL经典50题

**一、数据表建立**
    <details>
      <summary>创建如下图数据表的sql语句</summary>

    --创建学生信息表
    CREATE TABLE Student(S varchar(10),Sname varchar(10),Sage datetime,Ssex nvarchar(10));
    --创建课程表
    CREATE TABLE Course(C varchar(10),Cname varchar(10),T varchar(10));
    --创建老师表
    CREATE TABLE Teacher(T varchar(10),Tname varchar(10));
    --创建成绩表
    CREATE TABLE SC(S varchar(10),C varchar(10),Score decimal(18,1));
    
    --添加学生
    INSERT INTO Student VALUES('01' , '赵雷' , '1990-01-01' , '男');
    INSERT INTO Student VALUES('02' , '钱电' , '1990-12-21' , '男');
    INSERT INTO Student VALUES('03' , '孙风' , '1990-05-20' , '男');
    INSERT INTO Student VALUES('04' , '李云' , '1990-08-06' , '男');
    INSERT INTO Student VALUES('05' , '周梅' , '1991-12-01' , '女');
    INSERT INTO Student VALUES('06' , '吴兰' , '1992-03-01' , '女');
    INSERT INTO Student VALUES('07' , '郑竹' , '1989-07-01' , '女');
    INSERT INTO Student VALUES('08' , '王菊' , '1990-01-20' , '女');
    --添加课程
    INSERT INTO Course VALUES('01' , '语文' , '02');
    INSERT INTO Course VALUES('02' , '数学' , '01');
    INSERT INTO Course VALUES('03' , '英语' , '03');
    --添加老师信息
    INSERT INTO Teacher VALUES('01' , '张三');
    INSERT INTO Teacher VALUES('02' , '李四');
    INSERT INTO Teacher VALUES('03' , '王五');
    --添加成绩
    INSERT INTO SC VALUES('01' , '01' , 80);
    INSERT INTO SC VALUES('01' , '02' , 90);
    INSERT INTO SC VALUES('01' , '03' , 99);
    INSERT INTO SC VALUES('02' , '01' , 70);
    INSERT INTO SC VALUES('02' , '02' , 60);
    INSERT INTO SC VALUES('02' , '03' , 80);
    INSERT INTO SC VALUES('03' , '01' , 80);
    INSERT INTO SC VALUES('03' , '02' , 80);
    INSERT INTO SC VALUES('03' , '03' , 80);
    INSERT INTO SC VALUES('04' , '01' , 50);
    INSERT INTO SC VALUES('04' , '02' , 30);
    INSERT INTO SC VALUES('04' , '03' , 20);
    INSERT INTO SC VALUES('05' , '01' , 76);
    INSERT INTO SC VALUES('05' , '02' , 87);
    INSERT INTO SC VALUES('06' , '01' , 31);
    INSERT INTO SC VALUES('06' , '03' , 34);
    INSERT INTO SC VALUES('07' , '02' , 89);
    INSERT INTO SC VALUES('07' , '03' , 98);
</details>

   ![image](https://github.com/Anfany/Study-Tips-for-Other-Language/blob/master/SQL/sql_50.png)

---

**二、SQL经典50题**

   + 1 查询"01"课程比"02"课程成绩高的学生的学号。
       <details>
          <summary>sql语句</summary>
     
          --查询"01"课程比"02"课程成绩高的学生的学号

          SELECT a.S 学号
          FROM
              (SELECT SC.S, SC.Score FROM SC WHERE SC.C = '01') a, --查询有01课程成绩的学生的学号和对应的成绩
              (SELECT SC.S, SC.Score FROM SC WHERE SC.C = '02') b  --查询有02课程成绩的学生的学号和对应的成绩
          WHERE 
          a.S = b.S AND a.Score > b.Score --学号相同，成绩对比
            
      </details>
      
 
   + 2 查询平均成绩大于等于60分的同学的学生编号和学生姓名和平均成绩。
       <details>
          <summary>sql语句</summary>
     
          --查询平均成绩不低于60分的同学的学生编号和学生姓名和平均成绩

          SELECT b.S 学号, a.Sname 姓名, b.avgnum 平均成绩
          FROM
              (SELECT d.S, round(avg(d.Score), 1) avgnum 
              FROM SC d 
              GROUP BY d.s 
              HAVING avgnum >= 60) b, Student a --选择平均成绩不低于60分的学生的学号，以及平均成绩
          where b.S = a.S  
      </details>     
   
   + 3 查询所有学生的学号、姓名、选课总数、所有课程的总成绩。
       <details>
          <summary>sql语句</summary>
     
          --查询所有学生的学号、姓名、选课总数、所有课程的总成绩

          SELECT b.S 学号, d.Sname 姓名, b.zongshu 选课总数, b.chengji 总成绩
          FROM
              (SELECT a.S, count(*) zongshu, sum(a.Score) chengji
               FROM SC a 
               GROUP BY a.S) b, Student d  --和题2相似
          WHERE b.S = d.S 
      </details>   
      
   + 4 查询"李"姓老师的数量。
       <details>
          <summary>sql语句</summary>
     
          --查询李姓老师的数量

          SELECT count(*) 数量
          FROM Teacher t
          WHERE t.Tname LIKE '李%' -- like的用法
      </details>   
            
   + 5 查询学过张三老师课程的学生的学号、姓名、成绩。
       <details>
          <summary>sql语句</summary>
     
          --查询学过张三老师课程的学生的学号、姓名、成绩

          --通过表Teacher获得"张三"老师的编号
          --结合表Course获得对应的课程号
          --结合表SC获得学生的学号，成绩
          --根据表Student获得结果
          SELECT d.S 学号, f.Sname 姓名, d.Score 成绩
          FROM
             (SELECT s.S, h.Tname, s.Score 
             FROM
             SC s
             LEFT JOIN
                   (SELECT c.C, t.Tname 
                   FROM Course c
                   LEFT JOIN Teacher t
                  ON c.T = t.T) h
             ON s.C = h.C 
             WHERE h.Tname = '张三') d,
             Student f
         WHERE d.S = f.S

      </details>       
     
   + 6 查询同时有课程01和课程02的成绩的学生的学号、姓名、2科的成绩和。
       <details>
          <summary>sql语句</summary>
     
          --查询同时有课程01和课程02的成绩的学生的学号、姓名、2科的成绩和

          --获得课程编号01的学号、成绩
          --获得课程编号02的学号、成绩
          --union all表 
          --选择恰好有2条记录的,得到结果

          SELECT d.S 学号, t.Sname 姓名, d.he 成绩和
          FROM
             (SELECT f.S, sum(f.Score) he, count(f.S) cc
             FROM
                 (SELECT s.S, s.Score
                 FROM SC s
                 WHERE s.C = '01'
                 UNION All
                 SELECT s.S, s.Score
                 FROM SC s
                 WHERE s.C = '02') f
            GROUP BY f.S 
            HAVING cc = 2) d,
            Student t
         WHERE d.S = t.S

      </details>       
      
          
   + 7 --查询有成绩的课程比课程表中的课程少的学生的学号、姓名以及缺少成绩的课程名称。
       <details>
          <summary>sql语句</summary>
     
          --查询同时有课程01和课程02的成绩的学生的学号、姓名、2科的成绩和

          --获得课程编号01的学号、成绩
          --获得课程编号02的学号、成绩
          --union all表 
          --选择恰好有2条记录的,得到结果

          SELECT d.S 学号, t.Sname 姓名, d.he 成绩和
          FROM
             (SELECT f.S, sum(f.Score) he, count(f.S) cc
             FROM
                 (SELECT s.S, s.Score
                 FROM SC s
                 WHERE s.C = '01'
                 UNION All
                 SELECT s.S, s.Score
                 FROM SC s
                 WHERE s.C = '02') f
            GROUP BY f.S 
            HAVING cc = 2) d,
            Student t
         WHERE d.S = t.S

      </details>  
